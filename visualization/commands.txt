### Preparation

## Prepare Docker (once)
$ ../Tools/LinuxDocker
docker build -t linux .


## Generate Swapfile (once)
# Fixes memory problems together with the -Xms -Xmx arguments

docker run --rm -v /c/Users/user/Projekte/Fraunhofer/git:/wdir -it --privileged linux

# inside docker as privileged root
swapoff -a
dd if=/dev/zero of=/swapfile bs=1M count=4000
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
# to check if the swapfile is still there:
grep SwapTotal /proc/meminfo


### Execution after preparation
cd /c/Users/user/Projekte/Fraunhofer/git
# in $../git (using docker bash)
docker run --rm -v /c/Users/user/Projekte/Fraunhofer/git:/wdir -it linux

cd /wdir/ids-infomodel-codegen && mvn clean package -P PNL -pl :visualization -s ../.m2/settings.xml

cd visualization && export PLANTUML_LIMIT_SIZE=16384

# original command from bamboo
# java -Djava.awt.headless=true -jar /usr/share/plantuml/plantuml.jar all_classes.plantuml 
# command with memory adjustments for me
java -Djava.awt.headless=true -Xms4g -Xmx4g -jar /usr/share/plantuml/plantuml.jar all_classes.plantuml
