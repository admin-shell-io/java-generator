# This workflow will build a Java project with Maven, and cache/restore any dependencies to improve the workflow execution time
# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-maven

name: Deploy the

on:
  push:
    branches: [ main ]

jobs:


  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - uses: actions/checkout@master
        with:
          repository: admin-shell-io/aas-specs
          path: aas-specs
          ref: 81e9f3b7aabe4c0a77e738ba9f52415daf589cd6

      - name: Show current Working directory
        run: ls
        
      - name: Remove the examples
        run: rm -R aas-specs/schemas/rdf/examples

      - name: Set up JDK 11
        uses: actions/setup-java@v2
        with:
          java-version: '11'
          distribution: 'adopt'
          cache: maven
      
      - name: Build with Maven
        run: mvn -P CI-AAS -B package --file pom.xml

      - name: Pushes test file
        uses: dmnemec/copy_file_to_another_repo_action@main
        env:
          API_TOKEN_GITHUB: ${{ secrets.API_TOKEN_GITHUB }}
        with:
          source_file: 'aas/src/main/java/io/adminshell/aas/v3/model'
          destination_repo: 'sebbader/java-model'
          destination_folder: 'src/main/java/io/adminshell/aas/v3/model'
          user_email: 'sebastian.r.bader@web.de'
          user_name: 'Sebastian Bader'
          commit_message: 'this is an automated commit that was triggered by a change in the master branch of https://github.com/admin-shell-io/java-generator/'